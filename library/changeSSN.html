<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
    <input type="text" id="ssn" maxlength="13" oninput="changeFormat(this)">

    <h2>에스타르크처리</h2> 
    <div id="insertText"></div> <BR></BR>

    <H2>원본주민</H2>
    <div id="realSSN"></div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $('#ssn').blur(function(){
            console.log('bulr');
            if(realSSN.length == 13){
                realSSN = realSSN.substr(0,6)+'-'+realSSN.substr(6)
            }
            console.log(realSSN);
        })
        $('#ssn').click(function(){
            if(realSSN.substr(6,1)=='-'){
                realSSN = realSSN.substr(0,6)+realSSN.substr(7)
            }
            console.log(realSSN)
        })


        String.prototype.replaceAt = function(index,character){
            return this.substr(0, index) + character + this.substr(index+character.length);
        }

        var realSSN='';



        function changeFormat(object){
            
            estarc(object);
           
        }

        function estarc(object){
            var value = object.value;

            lastStr = value.substr(value.length-1);
         
            console.log('lastStr : ',lastStr);
            console.log('길이',value.length);

            if(value.length > realSSN.length){
                realSSN +=lastStr;

                console.log(value.length)
                if(value.length>6){
                    // value = value + lastStr;
                    value = value.replaceAt(value.length-1,'*');
                    setTimeout(() => {
                        document.getElementById('ssn').value = value;    
                    }, 30);

                    
                }

            }else{
                if(realSSN.includes('-')){
                    realSSN.split('-').join();
                    console.log(realSSN);
                }
                realSSN = realSSN.substr(0,value.length);
            }

            console.log('realSSN : ',realSSN);
            console.log('입력값 : ',value);

            document.getElementById('insertText').innerHTML=value;
            document.getElementById('realSSN').innerHTML=realSSN;
        }
    </script>
</body>
</html>